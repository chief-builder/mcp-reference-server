<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Protocol API | MCP Reference Server</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Protocol API" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A learning project implementing the Model Context Protocol (MCP) 2025-11-25 specification" />
<meta property="og:description" content="A learning project implementing the Model Context Protocol (MCP) 2025-11-25 specification" />
<link rel="canonical" href="http://localhost:4000/api/protocol.html" />
<meta property="og:url" content="http://localhost:4000/api/protocol.html" />
<meta property="og:site_name" content="MCP Reference Server" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Protocol API" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"A learning project implementing the Model Context Protocol (MCP) 2025-11-25 specification","headline":"Protocol API","url":"http://localhost:4000/api/protocol.html"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=4084654cb939e8940665a91c4c56b28d8f437143">
    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1><a href="http://localhost:4000/">MCP Reference Server</a></h1>

        

        <p>A learning project implementing the Model Context Protocol (MCP) 2025-11-25 specification</p>

        
        <p class="view"><a href="https://github.com/chiefbuilder/mcp-reference-server">View the Project on GitHub <small>chiefbuilder/mcp-reference-server</small></a></p>
        

        

        
      </header>
      <section>

      <h1 id="protocol-api-reference">Protocol API Reference</h1>

<p>Exports for JSON-RPC, lifecycle management, capabilities, and error handling.</p>

<h2 id="json-rpc-protocoljsonrpc">JSON-RPC (<code class="language-plaintext highlighter-rouge">protocol/jsonrpc</code>)</h2>

<h3 id="types">Types</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">interface</span> <span class="nx">JsonRpcRequest</span> <span class="p">{</span>
  <span class="nl">jsonrpc</span><span class="p">:</span> <span class="dl">'</span><span class="s1">2.0</span><span class="dl">'</span><span class="p">;</span>
  <span class="nl">id</span><span class="p">:</span> <span class="kr">string</span> <span class="o">|</span> <span class="kr">number</span><span class="p">;</span>
  <span class="nl">method</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">params</span><span class="p">?:</span> <span class="nx">unknown</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">interface</span> <span class="nx">JsonRpcResponse</span> <span class="p">{</span>
  <span class="nl">jsonrpc</span><span class="p">:</span> <span class="dl">'</span><span class="s1">2.0</span><span class="dl">'</span><span class="p">;</span>
  <span class="nl">id</span><span class="p">:</span> <span class="kr">string</span> <span class="o">|</span> <span class="kr">number</span> <span class="o">|</span> <span class="kc">null</span><span class="p">;</span>
  <span class="nl">result</span><span class="p">?:</span> <span class="nx">unknown</span><span class="p">;</span>
  <span class="nl">error</span><span class="p">?:</span> <span class="nx">JsonRpcError</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">interface</span> <span class="nx">JsonRpcNotification</span> <span class="p">{</span>
  <span class="nl">jsonrpc</span><span class="p">:</span> <span class="dl">'</span><span class="s1">2.0</span><span class="dl">'</span><span class="p">;</span>
  <span class="nl">method</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">params</span><span class="p">?:</span> <span class="nx">unknown</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">interface</span> <span class="nx">JsonRpcError</span> <span class="p">{</span>
  <span class="nl">code</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
  <span class="nl">message</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">data</span><span class="p">?:</span> <span class="nx">unknown</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="constants">Constants</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">JsonRpcErrorCodes</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">PARSE_ERROR</span><span class="p">:</span> <span class="o">-</span><span class="mi">32700</span><span class="p">,</span>
  <span class="na">INVALID_REQUEST</span><span class="p">:</span> <span class="o">-</span><span class="mi">32600</span><span class="p">,</span>
  <span class="na">METHOD_NOT_FOUND</span><span class="p">:</span> <span class="o">-</span><span class="mi">32601</span><span class="p">,</span>
  <span class="na">INVALID_PARAMS</span><span class="p">:</span> <span class="o">-</span><span class="mi">32602</span><span class="p">,</span>
  <span class="na">INTERNAL_ERROR</span><span class="p">:</span> <span class="o">-</span><span class="mi">32603</span><span class="p">,</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="functions">Functions</h3>

<table>
  <thead>
    <tr>
      <th>Function</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">createRequest(id, method, params?)</code></td>
      <td>Create a JSON-RPC request</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">createResponse(id, result)</code></td>
      <td>Create a success response</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">createErrorResponse(id, error)</code></td>
      <td>Create an error response</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">createNotification(method, params?)</code></td>
      <td>Create a notification</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">createJsonRpcError(code, message, data?)</code></td>
      <td>Create an error object</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">isRequest(msg)</code></td>
      <td>Type guard for requests</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">isNotification(msg)</code></td>
      <td>Type guard for notifications</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">isResponse(msg)</code></td>
      <td>Type guard for responses</td>
    </tr>
  </tbody>
</table>

<h2 id="lifecycle-protocollifecycle">Lifecycle (<code class="language-plaintext highlighter-rouge">protocol/lifecycle</code>)</h2>

<h3 id="constants-1">Constants</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">PROTOCOL_VERSION</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">2025-11-25</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div></div>

<h3 id="types-1">Types</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">type</span> <span class="nx">ServerState</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">uninitialized</span><span class="dl">'</span> <span class="o">|</span> <span class="dl">'</span><span class="s1">initializing</span><span class="dl">'</span> <span class="o">|</span> <span class="dl">'</span><span class="s1">ready</span><span class="dl">'</span> <span class="o">|</span> <span class="dl">'</span><span class="s1">shutting_down</span><span class="dl">'</span><span class="p">;</span>

<span class="kr">interface</span> <span class="nx">InitializeParams</span> <span class="p">{</span>
  <span class="nl">protocolVersion</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">capabilities</span><span class="p">:</span> <span class="nx">ClientCapabilities</span><span class="p">;</span>
  <span class="nl">clientInfo</span><span class="p">:</span> <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span> <span class="nl">version</span><span class="p">:</span> <span class="kr">string</span> <span class="p">};</span>
<span class="p">}</span>

<span class="kr">interface</span> <span class="nx">InitializeResult</span> <span class="p">{</span>
  <span class="nl">protocolVersion</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">capabilities</span><span class="p">:</span> <span class="nx">ServerCapabilities</span><span class="p">;</span>
  <span class="nl">serverInfo</span><span class="p">:</span> <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span> <span class="nl">version</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span> <span class="nl">description</span><span class="p">?:</span> <span class="kr">string</span> <span class="p">};</span>
  <span class="nl">instructions</span><span class="p">?:</span> <span class="kr">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">interface</span> <span class="nx">ServerConfig</span> <span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">version</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">description</span><span class="p">?:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">capabilities</span><span class="p">?:</span> <span class="nx">ServerCapabilities</span><span class="p">;</span>
  <span class="nl">instructions</span><span class="p">?:</span> <span class="kr">string</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="lifecyclemanager-class">LifecycleManager Class</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">LifecycleManager</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">config</span><span class="p">:</span> <span class="nx">ServerConfig</span><span class="p">);</span>
  <span class="nx">getState</span><span class="p">():</span> <span class="nx">ServerState</span><span class="p">;</span>
  <span class="nx">getClientInfo</span><span class="p">():</span> <span class="p">{</span> <span class="nl">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span> <span class="nl">version</span><span class="p">:</span> <span class="kr">string</span> <span class="p">}</span> <span class="o">|</span> <span class="kc">null</span><span class="p">;</span>
  <span class="nx">getClientCapabilities</span><span class="p">():</span> <span class="nx">ClientCapabilities</span> <span class="o">|</span> <span class="kc">null</span><span class="p">;</span>
  <span class="nx">handleInitialize</span><span class="p">(</span><span class="nx">params</span><span class="p">:</span> <span class="nx">unknown</span><span class="p">):</span> <span class="nx">InitializeResult</span><span class="p">;</span>
  <span class="nx">handleInitialized</span><span class="p">():</span> <span class="k">void</span><span class="p">;</span>
  <span class="nx">initiateShutdown</span><span class="p">():</span> <span class="nx">boolean</span><span class="p">;</span>
  <span class="nx">isOperational</span><span class="p">():</span> <span class="nx">boolean</span><span class="p">;</span>
  <span class="nx">reset</span><span class="p">():</span> <span class="k">void</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="capabilities-protocolcapabilities">Capabilities (<code class="language-plaintext highlighter-rouge">protocol/capabilities</code>)</h2>

<h3 id="types-2">Types</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// This server's capabilities</span>
<span class="kr">interface</span> <span class="nx">ServerCapabilities</span> <span class="p">{</span>
  <span class="nl">tools</span><span class="p">?:</span> <span class="p">{</span> <span class="nx">listChanged</span><span class="p">?:</span> <span class="nx">boolean</span> <span class="p">};</span>
  <span class="nl">completions</span><span class="p">?:</span> <span class="nb">Record</span><span class="o">&lt;</span><span class="kr">string</span><span class="p">,</span> <span class="nx">unknown</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Example: what this server returns</span>
<span class="kd">const</span> <span class="nx">capabilities</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">tools</span><span class="p">:</span> <span class="p">{</span> <span class="na">listChanged</span><span class="p">:</span> <span class="kc">true</span> <span class="p">},</span>
  <span class="na">completions</span><span class="p">:</span> <span class="p">{}</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="capabilitymanager-class">CapabilityManager Class</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">CapabilityManager</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">lifecycleManager</span><span class="p">:</span> <span class="nx">LifecycleManager</span><span class="p">,</span> <span class="nx">serverCapabilities</span><span class="p">?:</span> <span class="nx">ServerCapabilities</span><span class="p">);</span>
  <span class="nx">getServerCapabilities</span><span class="p">():</span> <span class="nx">ServerCapabilities</span><span class="p">;</span>
  <span class="nx">getClientCapabilities</span><span class="p">():</span> <span class="nx">ClientCapabilities</span> <span class="o">|</span> <span class="kc">null</span><span class="p">;</span>
  <span class="nx">getNegotiatedCapabilities</span><span class="p">():</span> <span class="nx">NegotiatedCapabilities</span> <span class="o">|</span> <span class="kc">null</span><span class="p">;</span>
  <span class="nx">hasClientCapability</span><span class="p">(</span><span class="nx">path</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="nx">boolean</span><span class="p">;</span>
  <span class="nx">hasServerCapability</span><span class="p">(</span><span class="nx">path</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="nx">boolean</span><span class="p">;</span>
  <span class="nx">requireClientCapability</span><span class="p">(</span><span class="nx">path</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="k">void</span><span class="p">;</span>
  <span class="nx">requireServerCapability</span><span class="p">(</span><span class="nx">path</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="k">void</span><span class="p">;</span>
  <span class="nx">isMethodAllowed</span><span class="p">(</span><span class="nx">method</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="nx">boolean</span><span class="p">;</span>
  <span class="nx">validateMethodCapability</span><span class="p">(</span><span class="nx">method</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="k">void</span><span class="p">;</span>
  <span class="nx">canSendNotification</span><span class="p">(</span><span class="nx">method</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="nx">boolean</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="functions-1">Functions</h3>

<table>
  <thead>
    <tr>
      <th>Function</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">getDefaultServerCapabilities()</code></td>
      <td>Get default server capabilities</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">negotiateCapabilities(client, server)</code></td>
      <td>Negotiate capability set</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">hasCapabilityAtPath(caps, path)</code></td>
      <td>Check capability at path</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">getMethodCapabilityMapping()</code></td>
      <td>Get method to capability map</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">getNotificationCapabilityMapping()</code></td>
      <td>Get notification to capability map</td>
    </tr>
  </tbody>
</table>

<h2 id="errors-protocolerrors">Errors (<code class="language-plaintext highlighter-rouge">protocol/errors</code>)</h2>

<h3 id="types-3">Types</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">interface</span> <span class="nx">ToolResult</span> <span class="p">{</span>
  <span class="nl">content</span><span class="p">:</span> <span class="nx">Content</span><span class="p">[];</span>
  <span class="nl">isError</span><span class="p">?:</span> <span class="nx">boolean</span><span class="p">;</span>
  <span class="nl">structuredContent</span><span class="p">?:</span> <span class="nx">unknown</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">interface</span> <span class="nx">ErrorWithCode</span> <span class="p">{</span>
  <span class="nl">code</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
  <span class="nl">message</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">data</span><span class="p">?:</span> <span class="nx">unknown</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="functions-2">Functions</h3>

<table>
  <thead>
    <tr>
      <th>Function</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">createToolError(message, data?)</code></td>
      <td>Create tool execution error</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">isToolError(result)</code></td>
      <td>Check if result is an error</td>
    </tr>
  </tbody>
</table>

<h2 id="pagination-protocolpagination">Pagination (<code class="language-plaintext highlighter-rouge">protocol/pagination</code>)</h2>

<p>Cursor-based pagination for MCP list operations with secure, tamper-proof cursors.</p>

<h3 id="constants-2">Constants</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">DEFAULT_PAGE_SIZE</span><span class="p">,</span> <span class="nx">MAX_PAGE_SIZE</span><span class="p">,</span> <span class="nx">MIN_PAGE_SIZE</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">mcp-reference-server</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">DEFAULT_PAGE_SIZE</span>  <span class="c1">// 50</span>
<span class="nx">MAX_PAGE_SIZE</span>      <span class="c1">// 200</span>
<span class="nx">MIN_PAGE_SIZE</span>      <span class="c1">// 1</span>
</code></pre></div></div>

<h3 id="types-4">Types</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">interface</span> <span class="nx">PaginationParams</span> <span class="p">{</span>
  <span class="cm">/** Opaque cursor from previous response */</span>
  <span class="nl">cursor</span><span class="p">?:</span> <span class="kr">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">interface</span> <span class="nx">PaginatedResult</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="cm">/** Items in the current page */</span>
  <span class="na">items</span><span class="p">:</span> <span class="nx">T</span><span class="p">[];</span>
  <span class="cm">/** Cursor for next page, undefined if no more pages */</span>
  <span class="nl">nextCursor</span><span class="p">?:</span> <span class="kr">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">interface</span> <span class="nx">ParseCursorResult</span> <span class="p">{</span>
  <span class="cm">/** Whether parsing was successful */</span>
  <span class="nl">valid</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">;</span>
  <span class="cm">/** Offset from cursor (0 if invalid) */</span>
  <span class="nl">offset</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
  <span class="cm">/** Error message if invalid */</span>
  <span class="nl">error</span><span class="p">?:</span> <span class="kr">string</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="functions-3">Functions</h3>

<table>
  <thead>
    <tr>
      <th>Function</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">createCursor(offset, metadata?)</code></td>
      <td>Create a Base64-encoded opaque cursor</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">parseCursor(cursor)</code></td>
      <td>Parse and validate a cursor, returns <code class="language-plaintext highlighter-rouge">ParseCursorResult</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">paginate(items, cursor?, pageSize?)</code></td>
      <td>Apply pagination to an array</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">clampPageSize(pageSize?, default?, max?)</code></td>
      <td>Clamp page size to valid range</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">emptyPaginatedResult()</code></td>
      <td>Create an empty paginated result</td>
    </tr>
  </tbody>
</table>

<h3 id="usage">Usage</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">paginate</span><span class="p">,</span> <span class="nx">DEFAULT_PAGE_SIZE</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">mcp-reference-server</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// Paginate a tools list</span>
<span class="kd">const</span> <span class="nx">tools</span> <span class="o">=</span> <span class="p">[</span><span class="cm">/* array of tools */</span><span class="p">];</span>
<span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">paginate</span><span class="p">(</span><span class="nx">tools</span><span class="p">,</span> <span class="nx">params</span><span class="p">.</span><span class="nx">cursor</span><span class="p">,</span> <span class="nx">DEFAULT_PAGE_SIZE</span><span class="p">);</span>

<span class="c1">// Response includes items and optional nextCursor</span>
<span class="k">return</span> <span class="p">{</span>
  <span class="na">tools</span><span class="p">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">items</span><span class="p">,</span>
  <span class="na">nextCursor</span><span class="p">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">nextCursor</span><span class="p">,</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="cursor-security">Cursor Security</h3>

<p>Cursors are tamper-proof using:</p>
<ul>
  <li>Base64-encoded JSON with offset and timestamp</li>
  <li>SHA-256 checksum validated on parse</li>
  <li>Configurable secret via <code class="language-plaintext highlighter-rouge">MCP_CURSOR_SECRET</code> environment variable</li>
</ul>

<h2 id="progress-notifications-protocolprogress">Progress Notifications (<code class="language-plaintext highlighter-rouge">protocol/progress</code>)</h2>

<p>Rate-limited progress notifications for long-running operations.</p>

<h3 id="constants-3">Constants</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">PROGRESS_NOTIFICATION_METHOD</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">mcp-reference-server</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">PROGRESS_NOTIFICATION_METHOD</span>  <span class="c1">// 'notifications/progress'</span>
</code></pre></div></div>

<h3 id="types-5">Types</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">type</span> <span class="nx">ProgressToken</span> <span class="o">=</span> <span class="kr">string</span> <span class="o">|</span> <span class="kr">number</span><span class="p">;</span>

<span class="kr">interface</span> <span class="nx">ProgressNotificationParams</span> <span class="p">{</span>
  <span class="nl">progressToken</span><span class="p">:</span> <span class="nx">ProgressToken</span><span class="p">;</span>
  <span class="nl">progress</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
  <span class="nl">total</span><span class="p">?:</span> <span class="kr">number</span><span class="p">;</span>
  <span class="nl">message</span><span class="p">?:</span> <span class="kr">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">interface</span> <span class="nx">ProgressReporterOptions</span> <span class="p">{</span>
  <span class="cm">/** Throttle interval in milliseconds (default: 100ms) */</span>
  <span class="nl">throttleMs</span><span class="p">?:</span> <span class="kr">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">SendNotificationFn</span> <span class="o">=</span> <span class="p">(</span><span class="nx">notification</span><span class="p">:</span> <span class="nx">JsonRpcNotification</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">;</span>
</code></pre></div></div>

<h3 id="progressreporter-class">ProgressReporter Class</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">ProgressReporter</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span>
    <span class="nx">token</span><span class="p">:</span> <span class="nx">ProgressToken</span><span class="p">,</span>
    <span class="nx">sendNotification</span><span class="p">:</span> <span class="nx">SendNotificationFn</span><span class="p">,</span>
    <span class="nx">options</span><span class="p">?:</span> <span class="nx">ProgressReporterOptions</span>
  <span class="p">);</span>

  <span class="cm">/** Report progress (throttled) */</span>
  <span class="nx">report</span><span class="p">(</span><span class="nx">progress</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span> <span class="nx">total</span><span class="p">?:</span> <span class="kr">number</span><span class="p">,</span> <span class="nx">message</span><span class="p">?:</span> <span class="kr">string</span><span class="p">):</span> <span class="k">void</span><span class="p">;</span>

  <span class="cm">/** Force final progress report (bypasses throttle) */</span>
  <span class="nx">complete</span><span class="p">(</span><span class="nx">message</span><span class="p">?:</span> <span class="kr">string</span><span class="p">):</span> <span class="k">void</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="functions-4">Functions</h3>

<table>
  <thead>
    <tr>
      <th>Function</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">extractProgressToken(params)</code></td>
      <td>Extract progressToken from request <code class="language-plaintext highlighter-rouge">_meta</code> field</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">createProgressReporter(params, sendFn, options?)</code></td>
      <td>Create reporter if token present</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">createProgressNotification(token, progress, total?, message?)</code></td>
      <td>Create a progress notification</td>
    </tr>
  </tbody>
</table>

<h3 id="usage-1">Usage</h3>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">createProgressReporter</span><span class="p">,</span> <span class="nx">extractProgressToken</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">mcp-reference-server</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// In a tool handler</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">handleLongOperation</span><span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="nx">sendNotification</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">reporter</span> <span class="o">=</span> <span class="nx">createProgressReporter</span><span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="nx">sendNotification</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">throttleMs</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>  <span class="c1">// Throttle to max 10 updates/second</span>
  <span class="p">});</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">reporter</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">items</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">await</span> <span class="nx">processItem</span><span class="p">(</span><span class="nx">items</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
      <span class="nx">reporter</span><span class="p">.</span><span class="nx">report</span><span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">items</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="s2">`Processing item </span><span class="p">${</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">reporter</span><span class="p">.</span><span class="nx">complete</span><span class="p">(</span><span class="dl">'</span><span class="s1">Done</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="throttling">Throttling</h3>

<p>The <code class="language-plaintext highlighter-rouge">ProgressReporter</code> automatically throttles updates:</p>
<ul>
  <li>Updates within the throttle interval are queued</li>
  <li>Only the most recent update is kept</li>
  <li><code class="language-plaintext highlighter-rouge">complete()</code> always sends the final notification</li>
</ul>

<h2 id="related">Related</h2>

<ul>
  <li><a href="../guides/protocol">Protocol Guide</a> - Protocol concepts</li>
  <li><a href="../reference/error-codes">Error Codes Reference</a> - All error codes</li>
</ul>


<hr>

<div class="nav-footer">
  <p><strong>Navigation:</strong>
    <a href="/">Home</a> |
    <a href="/getting-started/installation">Getting Started</a> |
    <a href="/guides/protocol">Guides</a> |
    <a href="/api/protocol">API Reference</a> |
    <a href="/examples/stdio-server">Examples</a> |
    <a href="/reference/environment">Reference</a>
  </p>
</div>



      </section>
      <footer>
        
        <p>This project is maintained by <a href="https://github.com/chiefbuilder">chiefbuilder</a></p>
        
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="/assets/js/scale.fix.js"></script>
  </body>
</html>
